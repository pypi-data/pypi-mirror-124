{"format_version":"0.1","terraform_version":"0.12.29","planned_values":{"root_module":{"resources":[{"address":"aws_cloudtrail.foobar","mode":"managed","type":"aws_cloudtrail","name":"foobar","provider_name":"aws","schema_version":0,"values":{"cloud_watch_logs_group_arn":null,"cloud_watch_logs_role_arn":null,"enable_log_file_validation":false,"enable_logging":true,"event_selector":[],"include_global_service_events":false,"insight_selector":[],"is_multi_region_trail":false,"is_organization_trail":false,"kms_key_id":"aws_kms_key.cloudrail.arn","name":"cloudtrail-logs-kms-cmk-encryption","s3_bucket_name":"aws_s3_bucket.foo.id","s3_key_prefix":"prefix","sns_topic_name":null,"tags":null}},{"address":"aws_kms_key.cloudrail","mode":"managed","type":"aws_kms_key","name":"cloudrail","provider_name":"aws","schema_version":0,"values":{"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":7,"description":"KMS key for Cloudrail encryption","enable_key_rotation":false,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","policy":"{\n    \"Version\": \"2012-10-17\",\n    \"Id\": \"Key Policy\",\n    \"Statement\": [\n        {\n            \"Sid\": \"Enable IAM User Permissions\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": [\n                    \"arn:aws:iam::data.aws_caller_identity.current.account_id:root\"\n                ]\n            },\n            \"Action\": \"kms:*\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"Allow CloudTrail to encrypt logs\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"Service\": \"cloudtrail.amazonaws.com\"\n            },\n            \"Action\": \"kms:GenerateDataKey*\",\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"StringLike\": {\n                    \"kms:EncryptionContext:aws:cloudtrail:arn\": \"arn:aws:cloudtrail:*:data.aws_caller_identity.current.account_id:trail/*\"\n                }\n            }\n        },\n        {\n            \"Sid\": \"Allow CloudTrail to describe key\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"Service\": \"cloudtrail.amazonaws.com\"\n            },\n            \"Action\": \"kms:DescribeKey\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"Allow principals in the account to decrypt log files\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"*\"\n            },\n            \"Action\": [\n                \"kms:Decrypt\",\n                \"kms:ReEncryptFrom\"\n            ],\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"StringEquals\": {\n                    \"kms:CallerAccount\": \"data.aws_caller_identity.current.account_id\"\n                },\n                \"StringLike\": {\n                    \"kms:EncryptionContext:aws:cloudtrail:arn\": \"arn:aws:cloudtrail:*:data.aws_caller_identity.current.account_id:trail/*\"\n                }\n            }\n        }\n    ]\n}\n","tags":null}},{"address":"aws_s3_bucket.foo","mode":"managed","type":"aws_s3_bucket","name":"foo","provider_name":"aws","schema_version":0,"values":{"acl":"private","bucket":"cloudtrail-logs-kms-cmk-encryption","bucket_prefix":null,"cors_rule":[],"force_destroy":true,"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"policy":"{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"AWSCloudTrailAclCheck\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n              \"Service\": \"cloudtrail.amazonaws.com\"\n            },\n            \"Action\": \"s3:GetBucketAcl\",\n            \"Resource\": \"arn:aws:s3:::cloudtrail-logs-kms-cmk-encryption\"\n        },\n        {\n            \"Sid\": \"AWSCloudTrailWrite\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n              \"Service\": \"cloudtrail.amazonaws.com\"\n            },\n            \"Action\": \"s3:PutObject\",\n            \"Resource\": \"arn:aws:s3:::cloudtrail-logs-kms-cmk-encryption/prefix/AWSLogs/data.aws_caller_identity.current.account_id/*\",\n            \"Condition\": {\n                \"StringEquals\": {\n                    \"s3:x-amz-acl\": \"bucket-owner-full-control\"\n                }\n            }\n        }\n    ]\n}\n","replication_configuration":[],"server_side_encryption_configuration":[],"tags":null,"website":[]}},{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_name":"aws","schema_version":0}]}},"resource_changes":[{"address":"aws_cloudtrail.foobar","mode":"managed","type":"aws_cloudtrail","name":"foobar","provider_name":"aws","change":{"actions":["create"],"before":null,"after":{"cloud_watch_logs_group_arn":null,"cloud_watch_logs_role_arn":null,"enable_log_file_validation":false,"enable_logging":true,"event_selector":[],"include_global_service_events":false,"insight_selector":[],"is_multi_region_trail":false,"is_organization_trail":false,"kms_key_id":"aws_kms_key.cloudrail.arn","name":"cloudtrail-logs-kms-cmk-encryption","s3_bucket_name":"aws_s3_bucket.foo.id","s3_key_prefix":"prefix","sns_topic_name":null,"tags":null},"after_unknown":{"arn":true,"event_selector":[],"home_region":true,"id":true,"insight_selector":[]}}},{"address":"aws_kms_key.cloudrail","mode":"managed","type":"aws_kms_key","name":"cloudrail","provider_name":"aws","change":{"actions":["create"],"before":null,"after":{"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":7,"description":"KMS key for Cloudrail encryption","enable_key_rotation":false,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","policy":"{\n    \"Version\": \"2012-10-17\",\n    \"Id\": \"Key Policy\",\n    \"Statement\": [\n        {\n            \"Sid\": \"Enable IAM User Permissions\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": [\n                    \"arn:aws:iam::data.aws_caller_identity.current.account_id:root\"\n                ]\n            },\n            \"Action\": \"kms:*\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"Allow CloudTrail to encrypt logs\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"Service\": \"cloudtrail.amazonaws.com\"\n            },\n            \"Action\": \"kms:GenerateDataKey*\",\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"StringLike\": {\n                    \"kms:EncryptionContext:aws:cloudtrail:arn\": \"arn:aws:cloudtrail:*:data.aws_caller_identity.current.account_id:trail/*\"\n                }\n            }\n        },\n        {\n            \"Sid\": \"Allow CloudTrail to describe key\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"Service\": \"cloudtrail.amazonaws.com\"\n            },\n            \"Action\": \"kms:DescribeKey\",\n            \"Resource\": \"*\"\n        },\n        {\n            \"Sid\": \"Allow principals in the account to decrypt log files\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"AWS\": \"*\"\n            },\n            \"Action\": [\n                \"kms:Decrypt\",\n                \"kms:ReEncryptFrom\"\n            ],\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"StringEquals\": {\n                    \"kms:CallerAccount\": \"data.aws_caller_identity.current.account_id\"\n                },\n                \"StringLike\": {\n                    \"kms:EncryptionContext:aws:cloudtrail:arn\": \"arn:aws:cloudtrail:*:data.aws_caller_identity.current.account_id:trail/*\"\n                }\n            }\n        }\n    ]\n}\n","tags":null},"after_unknown":{"arn":true,"id":true,"key_id":true}}},{"address":"aws_s3_bucket.foo","mode":"managed","type":"aws_s3_bucket","name":"foo","provider_name":"aws","change":{"actions":["create"],"before":null,"after":{"acl":"private","bucket":"cloudtrail-logs-kms-cmk-encryption","bucket_prefix":null,"cors_rule":[],"force_destroy":true,"grant":[],"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"policy":"{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"AWSCloudTrailAclCheck\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n              \"Service\": \"cloudtrail.amazonaws.com\"\n            },\n            \"Action\": \"s3:GetBucketAcl\",\n            \"Resource\": \"arn:aws:s3:::cloudtrail-logs-kms-cmk-encryption\"\n        },\n        {\n            \"Sid\": \"AWSCloudTrailWrite\",\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n              \"Service\": \"cloudtrail.amazonaws.com\"\n            },\n            \"Action\": \"s3:PutObject\",\n            \"Resource\": \"arn:aws:s3:::cloudtrail-logs-kms-cmk-encryption/prefix/AWSLogs/data.aws_caller_identity.current.account_id/*\",\n            \"Condition\": {\n                \"StringEquals\": {\n                    \"s3:x-amz-acl\": \"bucket-owner-full-control\"\n                }\n            }\n        }\n    ]\n}\n","replication_configuration":[],"server_side_encryption_configuration":[],"tags":null,"website":[]},"after_unknown":{"acceleration_status":true,"arn":true,"bucket_domain_name":true,"bucket_regional_domain_name":true,"cors_rule":[],"grant":[],"hosted_zone_id":true,"id":true,"lifecycle_rule":[],"logging":[],"object_lock_configuration":[],"region":true,"replication_configuration":[],"request_payer":true,"server_side_encryption_configuration":[],"versioning":true,"website":[],"website_domain":true,"website_endpoint":true}}},{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_name":"aws","change":{"actions":["read"],"before":null,"after":{},"after_unknown":{"account_id":true,"arn":true,"id":true,"user_id":true}}}],"configuration":{"provider_config":{"aws":{"name":"aws","expressions":{"region":{"constant_value":"us-east-1"}}}},"root_module":{"resources":[{"address":"aws_cloudtrail.foobar","mode":"managed","type":"aws_cloudtrail","name":"foobar","provider_config_key":"aws","expressions":{"include_global_service_events":{"constant_value":false},"kms_key_id":{"references":["aws_kms_key.cloudrail"]},"name":{"references":["local.name"]},"s3_bucket_name":{"references":["aws_s3_bucket.foo"]},"s3_key_prefix":{"constant_value":"prefix"}},"schema_version":0,"raw_data":{"FileName":"main.tf","StartLine":115,"EndLine":121}},{"address":"aws_kms_key.cloudrail","mode":"managed","type":"aws_kms_key","name":"cloudrail","provider_config_key":"aws","expressions":{"deletion_window_in_days":{"constant_value":7},"description":{"constant_value":"KMS key for Cloudrail encryption"},"policy":{"references":["data.aws_caller_identity.current","data.aws_caller_identity.current","data.aws_caller_identity.current","data.aws_caller_identity.current"]}},"schema_version":0,"raw_data":{"FileName":"main.tf","StartLine":11,"EndLine":76}},{"address":"aws_s3_bucket.foo","mode":"managed","type":"aws_s3_bucket","name":"foo","provider_config_key":"aws","expressions":{"bucket":{"references":["local.name"]},"force_destroy":{"constant_value":true},"policy":{"references":["local.name","local.name","data.aws_caller_identity.current"]}},"schema_version":0,"raw_data":{"FileName":"main.tf","StartLine":78,"EndLine":112}},{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_config_key":"aws","schema_version":0,"raw_data":{"FileName":"main.tf","StartLine":9,"EndLine":9}}]}}}
