{"format_version":"0.1","terraform_version":"0.13.4","planned_values":{"outputs":{"arn":{"sensitive":false,"value":"module.iam_policy.aws_iam_policy.policy.arn"},"description":{"sensitive":false,"value":"My example policy"},"id":{"sensitive":false,"value":"module.iam_policy.aws_iam_policy.policy.id"},"name":{"sensitive":false,"value":"example"},"path":{"sensitive":false,"value":"/"},"policy":{"sensitive":false,"value":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"ec2:Describe*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n"},"role_requires_mfa":{"sensitive":false,"value":true},"role_sts_externalid":{"sensitive":false,"value":"some-id-goes-here"},"this_iam_instance_profile_arn":{"sensitive":false,"value":""},"this_iam_instance_profile_name":{"sensitive":false,"value":""},"this_iam_instance_profile_path":{"sensitive":false,"value":""},"this_iam_role_arn":{"sensitive":false,"value":"module.iam_assumable_role_admin.aws_iam_role.this[0].arn"},"this_iam_role_name":{"sensitive":false,"value":"admin"},"this_iam_role_path":{"sensitive":false,"value":"/"}},"root_module":{"child_modules":[{"resources":[{"address":"module.iam_assumable_role_admin.aws_iam_role.this[0]","mode":"managed","type":"aws_iam_role","name":"this","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"AWS\": [\n          \"arn:aws:iam::835367859851:user/anton\",\n          \"arn:aws:iam::307990089504:root\"\n        ],\n        \"Service\": \"codedeploy.amazonaws.com\"\n      },\n      \"Condition\": {\n        \"Bool\": {\n          \"aws:MultiFactorAuthPresent\": [\n            \"true\"\n          ]\n        },\n        \"NumericLessThan\": {\n          \"aws:MultiFactorAuthAge\": [\n            \"86400\"\n          ]\n        }\n      }\n    }\n  ]\n}","description":"","force_detach_policies":false,"inline_policy":[],"max_session_duration":3600,"name":"admin","name_prefix":null,"path":"/","permissions_boundary":"","tags":{"Role":"Admin"},"tags_all":{"Role":"Admin"}}},{"address":"module.iam_assumable_role_admin.aws_iam_role_policy_attachment.admin[0]","mode":"managed","type":"aws_iam_role_policy_attachment","name":"admin","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy_arn":"arn:aws:iam::aws:policy/AdministratorAccess","role":"admin"}}],"address":"module.iam_assumable_role_admin"},{"resources":[{"address":"module.iam_assumable_role_custom.aws_iam_role.this[0]","mode":"managed","type":"aws_iam_role","name":"this","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"AWS\": \"arn:aws:iam::307990089504:root\",\n        \"Service\": \"codedeploy.amazonaws.com\"\n      },\n      \"Condition\": {\n        \"StringEquals\": {\n          \"sts:ExternalId\": [\n            \"some-id-goes-here\"\n          ]\n        }\n      }\n    }\n  ]\n}","description":"","force_detach_policies":false,"inline_policy":[],"max_session_duration":3600,"name":"custom","name_prefix":null,"path":"/","permissions_boundary":"","tags":{}}},{"address":"module.iam_assumable_role_custom.aws_iam_role_policy_attachment.custom[0]","mode":"managed","type":"aws_iam_role_policy_attachment","name":"custom","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy_arn":"arn:aws:iam::aws:policy/AmazonCognitoReadOnly","role":"custom"}},{"address":"module.iam_assumable_role_custom.aws_iam_role_policy_attachment.custom[1]","mode":"managed","type":"aws_iam_role_policy_attachment","name":"custom","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy_arn":"arn:aws:iam::aws:policy/AlexaForBusinessFullAccess","role":"custom"}},{"address":"module.iam_assumable_role_custom.aws_iam_role_policy_attachment.custom[2]","mode":"managed","type":"aws_iam_role_policy_attachment","name":"custom","index":2,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy_arn":"module.iam_policy.aws_iam_policy.policy.arn","role":"custom"}}],"address":"module.iam_assumable_role_custom"},{"resources":[{"address":"module.iam_policy.aws_iam_policy.policy","mode":"managed","type":"aws_iam_policy","name":"policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"My example policy","name":"example","name_prefix":null,"path":"/","policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"ec2:Describe*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n","tags":null}}],"address":"module.iam_policy"}]}},"resource_changes":[{"address":"module.iam_assumable_role_admin.aws_iam_role.this[0]","module_address":"module.iam_assumable_role_admin","mode":"managed","type":"aws_iam_role","name":"this","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"AWS\": [\n          \"arn:aws:iam::835367859851:user/anton\",\n          \"arn:aws:iam::307990089504:root\"\n        ],\n        \"Service\": \"codedeploy.amazonaws.com\"\n      },\n      \"Condition\": {\n        \"Bool\": {\n          \"aws:MultiFactorAuthPresent\": [\n            \"true\"\n          ]\n        },\n        \"NumericLessThan\": {\n          \"aws:MultiFactorAuthAge\": [\n            \"86400\"\n          ]\n        }\n      }\n    }\n  ]\n}","description":"","force_detach_policies":false,"inline_policy":[],"max_session_duration":3600,"name":"admin","name_prefix":null,"path":"/","permissions_boundary":"","tags":{"Role":"Admin"},"tags_all":{"Role":"Admin"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":[],"managed_policy_arns":true,"tags":{},"tags_all":{},"unique_id":true}}},{"address":"module.iam_assumable_role_admin.aws_iam_role_policy_attachment.admin[0]","module_address":"module.iam_assumable_role_admin","mode":"managed","type":"aws_iam_role_policy_attachment","name":"admin","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy_arn":"arn:aws:iam::aws:policy/AdministratorAccess","role":"admin"},"after_unknown":{"id":true}}},{"address":"module.iam_assumable_role_custom.aws_iam_role.this[0]","module_address":"module.iam_assumable_role_custom","mode":"managed","type":"aws_iam_role","name":"this","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"AWS\": \"arn:aws:iam::307990089504:root\",\n        \"Service\": \"codedeploy.amazonaws.com\"\n      },\n      \"Condition\": {\n        \"StringEquals\": {\n          \"sts:ExternalId\": [\n            \"some-id-goes-here\"\n          ]\n        }\n      }\n    }\n  ]\n}","description":"","force_detach_policies":false,"inline_policy":[],"max_session_duration":3600,"name":"custom","name_prefix":null,"path":"/","permissions_boundary":"","tags":{}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":[],"managed_policy_arns":true,"tags":{},"tags_all":true,"unique_id":true}}},{"address":"module.iam_assumable_role_custom.aws_iam_role_policy_attachment.custom[0]","module_address":"module.iam_assumable_role_custom","mode":"managed","type":"aws_iam_role_policy_attachment","name":"custom","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy_arn":"arn:aws:iam::aws:policy/AmazonCognitoReadOnly","role":"custom"},"after_unknown":{"id":true}}},{"address":"module.iam_assumable_role_custom.aws_iam_role_policy_attachment.custom[1]","module_address":"module.iam_assumable_role_custom","mode":"managed","type":"aws_iam_role_policy_attachment","name":"custom","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy_arn":"arn:aws:iam::aws:policy/AlexaForBusinessFullAccess","role":"custom"},"after_unknown":{"id":true}}},{"address":"module.iam_assumable_role_custom.aws_iam_role_policy_attachment.custom[2]","module_address":"module.iam_assumable_role_custom","mode":"managed","type":"aws_iam_role_policy_attachment","name":"custom","index":2,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy_arn":"module.iam_policy.aws_iam_policy.policy.arn","role":"custom"},"after_unknown":{"id":true}}},{"address":"module.iam_policy.aws_iam_policy.policy","module_address":"module.iam_policy","mode":"managed","type":"aws_iam_policy","name":"policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"My example policy","name":"example","name_prefix":null,"path":"/","policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"ec2:Describe*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n","tags":null},"after_unknown":{"arn":true,"id":true,"policy_id":true,"tags_all":true}}}],"output_changes":{"arn":{"actions":["create"],"before":null,"after":"module.iam_policy.aws_iam_policy.policy.arn","after_unknown":false},"description":{"actions":["create"],"before":null,"after":"My example policy","after_unknown":false},"id":{"actions":["create"],"before":null,"after":"module.iam_policy.aws_iam_policy.policy.id","after_unknown":false},"name":{"actions":["create"],"before":null,"after":"example","after_unknown":false},"path":{"actions":["create"],"before":null,"after":"/","after_unknown":false},"policy":{"actions":["create"],"before":null,"after":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"ec2:Describe*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n","after_unknown":false},"role_requires_mfa":{"actions":["create"],"before":null,"after":true,"after_unknown":false},"role_sts_externalid":{"actions":["create"],"before":null,"after":"some-id-goes-here","after_unknown":false},"this_iam_instance_profile_arn":{"actions":["create"],"before":null,"after":"","after_unknown":false},"this_iam_instance_profile_name":{"actions":["create"],"before":null,"after":"","after_unknown":false},"this_iam_instance_profile_path":{"actions":["create"],"before":null,"after":"","after_unknown":false},"this_iam_role_arn":{"actions":["create"],"before":null,"after":"module.iam_assumable_role_admin.aws_iam_role.this[0].arn","after_unknown":false},"this_iam_role_name":{"actions":["create"],"before":null,"after":"admin","after_unknown":false},"this_iam_role_path":{"actions":["create"],"before":null,"after":"/","after_unknown":false}},"prior_state":{"format_version":"0.1","terraform_version":"0.13.4","values":{"outputs":{"role_requires_mfa":{"sensitive":false,"value":true}},"root_module":{"child_modules":[{"resources":[{"address":"module.iam_assumable_role_admin.data.aws_iam_policy_document.assume_role","mode":"data","type":"aws_iam_policy_document","name":"assume_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"2763623201","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"AWS\": [\n          \"arn:aws:iam::835367859851:user/anton\",\n          \"arn:aws:iam::307990089504:root\"\n        ],\n        \"Service\": \"codedeploy.amazonaws.com\"\n      }\n    }\n  ]\n}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["arn:aws:iam::307990089504:root","arn:aws:iam::835367859851:user/anton"],"type":"AWS"},{"identifiers":["codedeploy.amazonaws.com"],"type":"Service"}],"resources":[],"sid":""}],"version":"2012-10-17"}},{"address":"module.iam_assumable_role_admin.data.aws_iam_policy_document.assume_role_with_mfa","mode":"data","type":"aws_iam_policy_document","name":"assume_role_with_mfa","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"3694494701","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"AWS\": [\n          \"arn:aws:iam::835367859851:user/anton\",\n          \"arn:aws:iam::307990089504:root\"\n        ],\n        \"Service\": \"codedeploy.amazonaws.com\"\n      },\n      \"Condition\": {\n        \"Bool\": {\n          \"aws:MultiFactorAuthPresent\": [\n            \"true\"\n          ]\n        },\n        \"NumericLessThan\": {\n          \"aws:MultiFactorAuthAge\": [\n            \"86400\"\n          ]\n        }\n      }\n    }\n  ]\n}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole"],"condition":[{"test":"Bool","values":["true"],"variable":"aws:MultiFactorAuthPresent"},{"test":"NumericLessThan","values":["86400"],"variable":"aws:MultiFactorAuthAge"}],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["arn:aws:iam::307990089504:root","arn:aws:iam::835367859851:user/anton"],"type":"AWS"},{"identifiers":["codedeploy.amazonaws.com"],"type":"Service"}],"resources":[],"sid":""}],"version":"2012-10-17"}}],"address":"module.iam_assumable_role_admin"},{"resources":[{"address":"module.iam_assumable_role_custom.data.aws_iam_policy_document.assume_role","mode":"data","type":"aws_iam_policy_document","name":"assume_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"1561262078","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"AWS\": \"arn:aws:iam::307990089504:root\",\n        \"Service\": \"codedeploy.amazonaws.com\"\n      },\n      \"Condition\": {\n        \"StringEquals\": {\n          \"sts:ExternalId\": [\n            \"some-id-goes-here\"\n          ]\n        }\n      }\n    }\n  ]\n}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole"],"condition":[{"test":"StringEquals","values":["some-id-goes-here"],"variable":"sts:ExternalId"}],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["arn:aws:iam::307990089504:root"],"type":"AWS"},{"identifiers":["codedeploy.amazonaws.com"],"type":"Service"}],"resources":[],"sid":""}],"version":"2012-10-17"}},{"address":"module.iam_assumable_role_custom.data.aws_iam_policy_document.assume_role_with_mfa","mode":"data","type":"aws_iam_policy_document","name":"assume_role_with_mfa","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"2483664549","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"AWS\": \"arn:aws:iam::307990089504:root\",\n        \"Service\": \"codedeploy.amazonaws.com\"\n      },\n      \"Condition\": {\n        \"Bool\": {\n          \"aws:MultiFactorAuthPresent\": [\n            \"true\"\n          ]\n        },\n        \"NumericLessThan\": {\n          \"aws:MultiFactorAuthAge\": [\n            \"86400\"\n          ]\n        }\n      }\n    }\n  ]\n}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole"],"condition":[{"test":"Bool","values":["true"],"variable":"aws:MultiFactorAuthPresent"},{"test":"NumericLessThan","values":["86400"],"variable":"aws:MultiFactorAuthAge"}],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["arn:aws:iam::307990089504:root"],"type":"AWS"},{"identifiers":["codedeploy.amazonaws.com"],"type":"Service"}],"resources":[],"sid":""}],"version":"2012-10-17"}}],"address":"module.iam_assumable_role_custom"}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","expressions":{"region":{"constant_value":"eu-west-1"}}}},"root_module":{"outputs":{"role_requires_mfa":{"expression":{"references":["module.iam_assumable_role_admin.role_requires_mfa"]},"description":"Whether admin IAM role requires MFA"},"this_iam_role_arn":{"expression":{"references":["module.iam_assumable_role_admin.this_iam_role_arn"]},"description":"ARN of IAM role"},"this_iam_role_name":{"expression":{"references":["module.iam_assumable_role_admin.this_iam_role_name"]},"description":"Name of IAM role"},"this_iam_role_path":{"expression":{"references":["module.iam_assumable_role_admin.this_iam_role_path"]},"description":"Path of IAM role"}},"module_calls":{"iam_assumable_role_admin":{"source":"../../modules/iam-assumable-role","expressions":{"attach_admin_policy":{"constant_value":true},"create_role":{"constant_value":true},"role_name":{"constant_value":"admin"},"role_requires_mfa":{"constant_value":true},"tags":{"constant_value":{"Role":"Admin"}},"trusted_role_arns":{"constant_value":["arn:aws:iam::307990089504:root","arn:aws:iam::835367859851:user/anton"]},"trusted_role_services":{"constant_value":["codedeploy.amazonaws.com"]}},"module":{"outputs":{"role_requires_mfa":{"expression":{"references":["var.role_requires_mfa"]},"description":"Whether IAM role requires MFA"},"role_sts_externalid":{"expression":{"references":["var.role_sts_externalid"]},"description":"STS ExternalId condition value to use with a role"},"this_iam_instance_profile_arn":{"expression":{"references":["aws_iam_instance_profile.this"]},"description":"ARN of IAM instance profile"},"this_iam_instance_profile_name":{"expression":{"references":["aws_iam_instance_profile.this"]},"description":"Name of IAM instance profile"},"this_iam_instance_profile_path":{"expression":{"references":["aws_iam_instance_profile.this"]},"description":"Path of IAM instance profile"},"this_iam_role_arn":{"expression":{"references":["aws_iam_role.this"]},"description":"ARN of IAM role"},"this_iam_role_name":{"expression":{"references":["aws_iam_role.this"]},"description":"Name of IAM role"},"this_iam_role_path":{"expression":{"references":["aws_iam_role.this"]},"description":"Path of IAM role"}},"resources":[{"address":"aws_iam_instance_profile.this","mode":"managed","type":"aws_iam_instance_profile","name":"this","provider_config_key":"iam_assumable_role_admin:aws","expressions":{"name":{"references":["var.role_name"]},"path":{"references":["var.role_path"]},"role":{"references":["aws_iam_role.this[0]"]}},"schema_version":0,"count_expression":{"references":["var.create_role","var.create_instance_profile"]},"raw_data":{"FileName":"../../modules/iam-assumable-role/main.tf","StartLine":102,"EndLine":107}},{"address":"aws_iam_role.this","mode":"managed","type":"aws_iam_role","name":"this","provider_config_key":"iam_assumable_role_admin:aws","expressions":{"assume_role_policy":{"references":["var.role_requires_mfa","data.aws_iam_policy_document.assume_role_with_mfa","data.aws_iam_policy_document.assume_role"]},"description":{"references":["var.role_description"]},"force_detach_policies":{"references":["var.force_detach_policies"]},"max_session_duration":{"references":["var.max_session_duration"]},"name":{"references":["var.role_name"]},"path":{"references":["var.role_path"]},"permissions_boundary":{"references":["var.role_permissions_boundary_arn"]},"tags":{"references":["var.tags"]}},"schema_version":0,"count_expression":{"references":["var.create_role"]},"raw_data":{"FileName":"../../modules/iam-assumable-role/main.tf","StartLine":58,"EndLine":72}},{"address":"aws_iam_role_policy_attachment.admin","mode":"managed","type":"aws_iam_role_policy_attachment","name":"admin","provider_config_key":"iam_assumable_role_admin:aws","expressions":{"policy_arn":{"references":["var.admin_role_policy_arn"]},"role":{"references":["aws_iam_role.this[0]"]}},"schema_version":0,"count_expression":{"references":["var.create_role","var.attach_admin_policy"]},"raw_data":{"FileName":"../../modules/iam-assumable-role/main.tf","StartLine":81,"EndLine":86}},{"address":"aws_iam_role_policy_attachment.custom","mode":"managed","type":"aws_iam_role_policy_attachment","name":"custom","provider_config_key":"iam_assumable_role_admin:aws","expressions":{"policy_arn":{"references":["var.custom_role_policy_arns","count.index"]},"role":{"references":["aws_iam_role.this[0]"]}},"schema_version":0,"count_expression":{"references":["var.create_role","var.number_of_custom_role_policy_arns","var.custom_role_policy_arns"]},"raw_data":{"FileName":"../../modules/iam-assumable-role/main.tf","StartLine":74,"EndLine":79}},{"address":"aws_iam_role_policy_attachment.poweruser","mode":"managed","type":"aws_iam_role_policy_attachment","name":"poweruser","provider_config_key":"iam_assumable_role_admin:aws","expressions":{"policy_arn":{"references":["var.poweruser_role_policy_arn"]},"role":{"references":["aws_iam_role.this[0]"]}},"schema_version":0,"count_expression":{"references":["var.create_role","var.attach_poweruser_policy"]},"raw_data":{"FileName":"../../modules/iam-assumable-role/main.tf","StartLine":88,"EndLine":93}},{"address":"aws_iam_role_policy_attachment.readonly","mode":"managed","type":"aws_iam_role_policy_attachment","name":"readonly","provider_config_key":"iam_assumable_role_admin:aws","expressions":{"policy_arn":{"references":["var.readonly_role_policy_arn"]},"role":{"references":["aws_iam_role.this[0]"]}},"schema_version":0,"count_expression":{"references":["var.create_role","var.attach_readonly_policy"]},"raw_data":{"FileName":"../../modules/iam-assumable-role/main.tf","StartLine":95,"EndLine":100}},{"address":"data.aws_iam_policy_document.assume_role","mode":"data","type":"aws_iam_policy_document","name":"assume_role","provider_config_key":"iam_assumable_role_admin:aws","expressions":{"statement":[{"actions":{"references":["var.trusted_role_actions"]},"effect":{"constant_value":"Allow"},"principals":[{"identifiers":{"references":["var.trusted_role_arns"]},"type":{"constant_value":"AWS"}},{"identifiers":{"references":["var.trusted_role_services"]},"type":{"constant_value":"Service"}}]}]},"schema_version":0,"raw_data":{"FileName":"../../modules/iam-assumable-role/main.tf","StartLine":1,"EndLine":26}},{"address":"data.aws_iam_policy_document.assume_role_with_mfa","mode":"data","type":"aws_iam_policy_document","name":"assume_role_with_mfa","provider_config_key":"iam_assumable_role_admin:aws","expressions":{"statement":[{"actions":{"constant_value":["sts:AssumeRole"]},"condition":[{"test":{"constant_value":"Bool"},"values":{"constant_value":["true"]},"variable":{"constant_value":"aws:MultiFactorAuthPresent"}},{"test":{"constant_value":"NumericLessThan"},"values":{"references":["var.mfa_age"]},"variable":{"constant_value":"aws:MultiFactorAuthAge"}}],"effect":{"constant_value":"Allow"},"principals":[{"identifiers":{"references":["var.trusted_role_arns"]},"type":{"constant_value":"AWS"}},{"identifiers":{"references":["var.trusted_role_services"]},"type":{"constant_value":"Service"}}]}]},"schema_version":0,"raw_data":{"FileName":"../../modules/iam-assumable-role/main.tf","StartLine":28,"EndLine":56}}],"variables":{"admin_role_policy_arn":{"default":"arn:aws:iam::aws:policy/AdministratorAccess","description":"Policy ARN to use for admin role"},"attach_admin_policy":{"default":false,"description":"Whether to attach an admin policy to a role"},"attach_poweruser_policy":{"default":false,"description":"Whether to attach a poweruser policy to a role"},"attach_readonly_policy":{"default":false,"description":"Whether to attach a readonly policy to a role"},"create_instance_profile":{"default":false,"description":"Whether to create an instance profile"},"create_role":{"default":false,"description":"Whether to create a role"},"custom_role_policy_arns":{"default":[],"description":"List of ARNs of IAM policies to attach to IAM role"},"force_detach_policies":{"default":false,"description":"Whether policies should be detached from this role when destroying"},"max_session_duration":{"default":3600,"description":"Maximum CLI/API session duration in seconds between 3600 and 43200"},"mfa_age":{"default":86400,"description":"Max age of valid MFA (in seconds) for roles which require MFA"},"number_of_custom_role_policy_arns":{"default":null,"description":"Number of IAM policies to attach to IAM role"},"poweruser_role_policy_arn":{"default":"arn:aws:iam::aws:policy/PowerUserAccess","description":"Policy ARN to use for poweruser role"},"readonly_role_policy_arn":{"default":"arn:aws:iam::aws:policy/ReadOnlyAccess","description":"Policy ARN to use for readonly role"},"role_description":{"default":"","description":"IAM Role description"},"role_name":{"default":"","description":"IAM role name"},"role_path":{"default":"/","description":"Path of IAM role"},"role_permissions_boundary_arn":{"default":"","description":"Permissions boundary ARN to use for IAM role"},"role_requires_mfa":{"default":true,"description":"Whether role requires MFA"},"role_sts_externalid":{"default":null,"description":"STS ExternalId condition value to use with a role (when MFA is not required)"},"tags":{"default":{},"description":"A map of tags to add to IAM role resources"},"trusted_role_actions":{"default":["sts:AssumeRole"],"description":"Actions of STS"},"trusted_role_arns":{"default":[],"description":"ARNs of AWS entities who can assume these roles"},"trusted_role_services":{"default":[],"description":"AWS Services that can assume these roles"}}},"raw_data":{"FileName":"main.tf","StartLine":8,"EndLine":30}},"iam_assumable_role_custom":{"source":"../../modules/iam-assumable-role","expressions":{"create_role":{"constant_value":true},"custom_role_policy_arns":{"references":["module.iam_policy.arn"]},"role_name":{"constant_value":"custom"},"role_requires_mfa":{"constant_value":false},"role_sts_externalid":{"constant_value":"some-id-goes-here"},"trusted_role_arns":{"constant_value":["arn:aws:iam::307990089504:root"]},"trusted_role_services":{"constant_value":["codedeploy.amazonaws.com"]}},"module":{"outputs":{"role_requires_mfa":{"expression":{"references":["var.role_requires_mfa"]},"description":"Whether IAM role requires MFA"},"role_sts_externalid":{"expression":{"references":["var.role_sts_externalid"]},"description":"STS ExternalId condition value to use with a role"},"this_iam_instance_profile_arn":{"expression":{"references":["aws_iam_instance_profile.this"]},"description":"ARN of IAM instance profile"},"this_iam_instance_profile_name":{"expression":{"references":["aws_iam_instance_profile.this"]},"description":"Name of IAM instance profile"},"this_iam_instance_profile_path":{"expression":{"references":["aws_iam_instance_profile.this"]},"description":"Path of IAM instance profile"},"this_iam_role_arn":{"expression":{"references":["aws_iam_role.this"]},"description":"ARN of IAM role"},"this_iam_role_name":{"expression":{"references":["aws_iam_role.this"]},"description":"Name of IAM role"},"this_iam_role_path":{"expression":{"references":["aws_iam_role.this"]},"description":"Path of IAM role"}},"resources":[{"address":"aws_iam_instance_profile.this","mode":"managed","type":"aws_iam_instance_profile","name":"this","provider_config_key":"iam_assumable_role_custom:aws","expressions":{"name":{"references":["var.role_name"]},"path":{"references":["var.role_path"]},"role":{"references":["aws_iam_role.this[0]"]}},"schema_version":0,"count_expression":{"references":["var.create_role","var.create_instance_profile"]},"raw_data":{"FileName":"../../modules/iam-assumable-role/main.tf","StartLine":102,"EndLine":107}},{"address":"aws_iam_role.this","mode":"managed","type":"aws_iam_role","name":"this","provider_config_key":"iam_assumable_role_custom:aws","expressions":{"assume_role_policy":{"references":["var.role_requires_mfa","data.aws_iam_policy_document.assume_role_with_mfa","data.aws_iam_policy_document.assume_role"]},"description":{"references":["var.role_description"]},"force_detach_policies":{"references":["var.force_detach_policies"]},"max_session_duration":{"references":["var.max_session_duration"]},"name":{"references":["var.role_name"]},"path":{"references":["var.role_path"]},"permissions_boundary":{"references":["var.role_permissions_boundary_arn"]},"tags":{"references":["var.tags"]}},"schema_version":0,"count_expression":{"references":["var.create_role"]},"raw_data":{"FileName":"../../modules/iam-assumable-role/main.tf","StartLine":58,"EndLine":72}},{"address":"aws_iam_role_policy_attachment.admin","mode":"managed","type":"aws_iam_role_policy_attachment","name":"admin","provider_config_key":"iam_assumable_role_custom:aws","expressions":{"policy_arn":{"references":["var.admin_role_policy_arn"]},"role":{"references":["aws_iam_role.this[0]"]}},"schema_version":0,"count_expression":{"references":["var.create_role","var.attach_admin_policy"]},"raw_data":{"FileName":"../../modules/iam-assumable-role/main.tf","StartLine":81,"EndLine":86}},{"address":"aws_iam_role_policy_attachment.custom","mode":"managed","type":"aws_iam_role_policy_attachment","name":"custom","provider_config_key":"iam_assumable_role_custom:aws","expressions":{"policy_arn":{"references":["var.custom_role_policy_arns","count.index"]},"role":{"references":["aws_iam_role.this[0]"]}},"schema_version":0,"count_expression":{"references":["var.create_role","var.number_of_custom_role_policy_arns","var.custom_role_policy_arns"]},"raw_data":{"FileName":"../../modules/iam-assumable-role/main.tf","StartLine":74,"EndLine":79}},{"address":"aws_iam_role_policy_attachment.poweruser","mode":"managed","type":"aws_iam_role_policy_attachment","name":"poweruser","provider_config_key":"iam_assumable_role_custom:aws","expressions":{"policy_arn":{"references":["var.poweruser_role_policy_arn"]},"role":{"references":["aws_iam_role.this[0]"]}},"schema_version":0,"count_expression":{"references":["var.create_role","var.attach_poweruser_policy"]},"raw_data":{"FileName":"../../modules/iam-assumable-role/main.tf","StartLine":88,"EndLine":93}},{"address":"aws_iam_role_policy_attachment.readonly","mode":"managed","type":"aws_iam_role_policy_attachment","name":"readonly","provider_config_key":"iam_assumable_role_custom:aws","expressions":{"policy_arn":{"references":["var.readonly_role_policy_arn"]},"role":{"references":["aws_iam_role.this[0]"]}},"schema_version":0,"count_expression":{"references":["var.create_role","var.attach_readonly_policy"]},"raw_data":{"FileName":"../../modules/iam-assumable-role/main.tf","StartLine":95,"EndLine":100}},{"address":"data.aws_iam_policy_document.assume_role","mode":"data","type":"aws_iam_policy_document","name":"assume_role","provider_config_key":"iam_assumable_role_custom:aws","expressions":{"statement":[{"actions":{"references":["var.trusted_role_actions"]},"effect":{"constant_value":"Allow"},"principals":[{"identifiers":{"references":["var.trusted_role_arns"]},"type":{"constant_value":"AWS"}},{"identifiers":{"references":["var.trusted_role_services"]},"type":{"constant_value":"Service"}}]}]},"schema_version":0,"raw_data":{"FileName":"../../modules/iam-assumable-role/main.tf","StartLine":1,"EndLine":26}},{"address":"data.aws_iam_policy_document.assume_role_with_mfa","mode":"data","type":"aws_iam_policy_document","name":"assume_role_with_mfa","provider_config_key":"iam_assumable_role_custom:aws","expressions":{"statement":[{"actions":{"constant_value":["sts:AssumeRole"]},"condition":[{"test":{"constant_value":"Bool"},"values":{"constant_value":["true"]},"variable":{"constant_value":"aws:MultiFactorAuthPresent"}},{"test":{"constant_value":"NumericLessThan"},"values":{"references":["var.mfa_age"]},"variable":{"constant_value":"aws:MultiFactorAuthAge"}}],"effect":{"constant_value":"Allow"},"principals":[{"identifiers":{"references":["var.trusted_role_arns"]},"type":{"constant_value":"AWS"}},{"identifiers":{"references":["var.trusted_role_services"]},"type":{"constant_value":"Service"}}]}]},"schema_version":0,"raw_data":{"FileName":"../../modules/iam-assumable-role/main.tf","StartLine":28,"EndLine":56}}],"variables":{"admin_role_policy_arn":{"default":"arn:aws:iam::aws:policy/AdministratorAccess","description":"Policy ARN to use for admin role"},"attach_admin_policy":{"default":false,"description":"Whether to attach an admin policy to a role"},"attach_poweruser_policy":{"default":false,"description":"Whether to attach a poweruser policy to a role"},"attach_readonly_policy":{"default":false,"description":"Whether to attach a readonly policy to a role"},"create_instance_profile":{"default":false,"description":"Whether to create an instance profile"},"create_role":{"default":false,"description":"Whether to create a role"},"custom_role_policy_arns":{"default":[],"description":"List of ARNs of IAM policies to attach to IAM role"},"force_detach_policies":{"default":false,"description":"Whether policies should be detached from this role when destroying"},"max_session_duration":{"default":3600,"description":"Maximum CLI/API session duration in seconds between 3600 and 43200"},"mfa_age":{"default":86400,"description":"Max age of valid MFA (in seconds) for roles which require MFA"},"number_of_custom_role_policy_arns":{"default":null,"description":"Number of IAM policies to attach to IAM role"},"poweruser_role_policy_arn":{"default":"arn:aws:iam::aws:policy/PowerUserAccess","description":"Policy ARN to use for poweruser role"},"readonly_role_policy_arn":{"default":"arn:aws:iam::aws:policy/ReadOnlyAccess","description":"Policy ARN to use for readonly role"},"role_description":{"default":"","description":"IAM Role description"},"role_name":{"default":"","description":"IAM role name"},"role_path":{"default":"/","description":"Path of IAM role"},"role_permissions_boundary_arn":{"default":"","description":"Permissions boundary ARN to use for IAM role"},"role_requires_mfa":{"default":true,"description":"Whether role requires MFA"},"role_sts_externalid":{"default":null,"description":"STS ExternalId condition value to use with a role (when MFA is not required)"},"tags":{"default":{},"description":"A map of tags to add to IAM role resources"},"trusted_role_actions":{"default":["sts:AssumeRole"],"description":"Actions of STS"},"trusted_role_arns":{"default":[],"description":"ARNs of AWS entities who can assume these roles"},"trusted_role_services":{"default":[],"description":"AWS Services that can assume these roles"}}},"raw_data":{"FileName":"main.tf","StartLine":35,"EndLine":59}},"iam_policy":{"source":"../../modules/iam-policy","expressions":{"description":{"constant_value":"My example policy"},"name":{"constant_value":"example"},"path":{"constant_value":"/"},"policy":{"constant_value":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"ec2:Describe*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n"}},"module":{"outputs":{"arn":{"expression":{"references":["aws_iam_policy.policy"]},"description":"The ARN assigned by AWS to this policy"},"description":{"expression":{"references":["aws_iam_policy.policy"]},"description":"The description of the policy"},"id":{"expression":{"references":["aws_iam_policy.policy"]},"description":"The policy's ID"},"name":{"expression":{"references":["aws_iam_policy.policy"]},"description":"The name of the policy"},"path":{"expression":{"references":["aws_iam_policy.policy"]},"description":"The path of the policy in IAM"},"policy":{"expression":{"references":["aws_iam_policy.policy"]},"description":"The policy document"}},"resources":[{"address":"aws_iam_policy.policy","mode":"managed","type":"aws_iam_policy","name":"policy","provider_config_key":"iam_policy:aws","expressions":{"description":{"references":["var.description"]},"name":{"references":["var.name"]},"path":{"references":["var.path"]},"policy":{"references":["var.policy"]}},"schema_version":0,"raw_data":{"FileName":"../../modules/iam-policy/main.tf","StartLine":1,"EndLine":7}}],"variables":{"description":{"default":"IAM Policy","description":"The description of the policy"},"name":{"default":"","description":"The name of the policy"},"path":{"default":"/","description":"The path of the policy in IAM"},"policy":{"default":"","description":"The path of the policy in IAM (tpl file)"}}},"raw_data":{"FileName":"main.tf","StartLine":64,"EndLine":85}}}}}}
