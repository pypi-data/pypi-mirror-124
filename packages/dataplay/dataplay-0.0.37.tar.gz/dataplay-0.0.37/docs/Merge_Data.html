---

title: Merge Data


keywords: fastai
sidebar: home_sidebar

summary: "This notebook was made to demonstrate how to merge datasets by matching a single columns values from two datasets. We add columns of data from a foreign dataset into the ACS data we downloaded in our last tutorial."
description: "This notebook was made to demonstrate how to merge datasets by matching a single columns values from two datasets. We add columns of data from a foreign dataset into the ACS data we downloaded in our last tutorial."
nb_path: "notebooks/02_Merge_Data.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/02_Merge_Data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Please read everything found on the <a href="https://bniajfi.org/dataplay/">mainpage</a> before continuing; disclaimer and all.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://mybinder.org/v2/gh/bnia/dataplay/main?filepath=%2Fnotebooks%2F02_Merge_Data.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt="Binder"></a>
<a href="https://colab.research.google.com/github/bnia/dataplay/blob/main/notebooks/02_Merge_Data.ipynb"><img src="https://pete88b.github.io/fastpages/assets/badges/colab.svg" alt="Binder"></a>
<a href="https://github.com/bnia/dataplay/tree/main/notebooks/02_Merge_Data.ipynb"><img src="https://pete88b.github.io/fastpages/assets/badges/github.svg" alt="Binder"></a>
<a href="https://github.com/ellerbrock/open-source-badges/"><img src="https://badges.frapsoft.com/os/v3/open-source.svg?v=103" alt="Open Source Love svg3"></a></p>
<p><a href="https://github.com/bnia/dataplay/blob/main/LICENSE"><img src="https://img.shields.io/npm/l/all-contributors.svg?style=flat" alt="NPM License"></a>
<a href="https://bnia.github.io"><img src="http://img.shields.io/badge/Status-Active-green.svg" alt="Active"></a> 
<a href="https://pypi.python.org/pypi/dataplay/"><img src="https://img.shields.io/pypi/pyversions/dataplay.svg" alt="Python Versions"></a>
<a href=""><img src="https://img.shields.io/github/last-commit/bnia/dataplay.svg?style=flat" alt="GitHub last commit"></a></p>
<p><a href="https://github.com/bnia/dataplay"><img src="https://img.shields.io/github/stars/bnia/dataplay.svg?style=social&amp;label=Star" alt="GitHub stars"></a> 
<a href="https://github.com/bnia/dataplay"><img src="https://img.shields.io/github/watchers/bnia/dataplay.svg?style=social&amp;label=Watch" alt="GitHub watchers"></a> 
<a href="https://github.com/bnia/dataplay"><img src="https://img.shields.io/github/forks/bnia/dataplay.svg?style=social&amp;label=Fork" alt="GitHub forks"></a> 
<a href="https://github.com/bnia/dataplay"><img src="https://img.shields.io/github/followers/bnia.svg?style=social&amp;label=Follow" alt="GitHub followers"></a></p>
<p><a href="https://twitter.com/intent/tweet?text=Check%20out%20this%20%E2%9C%A8%20colab%20by%20@bniajfi%20https://github.com/bnia/dataplay%20%F0%9F%A4%97"><img src="https://img.shields.io/twitter/url/https/github.com/bnia/dataplay.svg?style=social" alt="Tweet"></a> 
<a href="https://twitter.com/bniajfi"><img src="https://img.shields.io/twitter/follow/bniajfi.svg?style=social" alt="Twitter Follow"></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="About-this-Tutorial:">About this Tutorial:<a class="anchor-link" href="#About-this-Tutorial:"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Whats-Inside?">Whats Inside?<a class="anchor-link" href="#Whats-Inside?"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="The-Tutorial"><strong>The Tutorial</strong><a class="anchor-link" href="#The-Tutorial"> </a></h4><p>In this notebook, the basics of how to perform a merge are introduced.</p>
<ul>
<li>We will merge two datasets</li>
<li>We will merge two datasets using a crosswalk</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Objectives"><strong>Objectives</strong><a class="anchor-link" href="#Objectives"> </a></h4><p>By the end of this tutorial users should have an understanding of:</p>
<ul>
<li>How dataset merges are performed</li>
<li>The types different union approaches a merge can take</li>
<li>The 'mergeData' function, and how to use it in the future</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Guided-Walkthrough">Guided Walkthrough<a class="anchor-link" href="#Guided-Walkthrough"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SETUP">SETUP<a class="anchor-link" href="#SETUP"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Install these libraries onto the virtual environment.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">capture</span>
!pip install geopandas
!pip install VitalSigns
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">VitalSigns.acsDownload</span> <span class="kn">import</span> <span class="n">retrieve_acs_data</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ls</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-intense-fg ansi-bold">build</span>/           <span class="ansi-blue-intense-fg ansi-bold">dataplay</span>/  <span class="ansi-blue-intense-fg ansi-bold">docs</span>/    Makefile     <span class="ansi-blue-intense-fg ansi-bold">notebooks</span>/  settings.ini
CONTRIBUTING.md  <span class="ansi-blue-intense-fg ansi-bold">dist</span>/      LICENSE  MANIFEST.in  README.md   setup.py
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>nbdev_update_lib -h
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>usage: nbdev_update_lib
       [-h]
       [--fname FNAME]
       [--silent SILENT]

Propagates
any change
in the
modules
matching
`fname` to
the
notebooks
that
created
them

optional arguments:
  -h, --help
show this
help
message and
exit
  --fname FNAME
A python
filename or
glob to
convert
  --silent SILENT
Don&#39;t print
results
(default:
False)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ls</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-blue-intense-fg ansi-bold">build</span>/           <span class="ansi-blue-intense-fg ansi-bold">dataplay</span>/  <span class="ansi-blue-intense-fg ansi-bold">docs</span>/    Makefile     <span class="ansi-blue-intense-fg ansi-bold">notebooks</span>/  settings.ini
CONTRIBUTING.md  <span class="ansi-blue-intense-fg ansi-bold">dist</span>/      LICENSE  MANIFEST.in  README.md   setup.py
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>nbdev_build_lib
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 01_Download_and_Load.ipynb.
Converted 02_Merge_Data.ipynb.
Converted 03_Map_Basics_Intake_and_Operations.ipynb.
Converted 04_nb_2_html.ipynb.
Converted 05_Map_Correlation_Networks.ipynb.
Converted 06_Timelapse_Data_Gifs.ipynb.
Converted index.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>nbdev_update_lib
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted intaker.py.
Converted merge.py.
Converted geoms.py.
Converted gifmap.py.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># !nbdev_build_lib --fname &#39;./notebooks/02_Merge_Data.ipynb&#39;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 01_Download_and_Load.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Retrieve-Datasets">Retrieve Datasets<a class="anchor-link" href="#Retrieve-Datasets"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our example will merge two simple datasets; pulling CSA names using tract ID's.</p>
<p>The <strong>First</strong> dataset will be obtained from the Census' ACS 5-year serveys.</p>
<p>Functions used to obtain this data were obtained from Tutorial 0) ACS: Explore and Download.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <strong>Second</strong> dataset is from a publicly accessible link</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get-the-Principal-dataset.">Get the Principal dataset.<a class="anchor-link" href="#Get-the-Principal-dataset."> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will use the function we created in our last tutorial to download the data!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Change these values in the cell below using different geographic reference codes will change those parameters</span>
<span class="n">tract</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span>
<span class="n">county</span> <span class="o">=</span> <span class="s1">&#39;510&#39;</span>
<span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;24&#39;</span>

<span class="c1"># Specify the download parameters the function will receieve here</span>
<span class="n">tableId</span> <span class="o">=</span> <span class="s1">&#39;B19001&#39;</span>
<span class="n">year</span> <span class="o">=</span> <span class="s1">&#39;17&#39;</span>
<span class="n">saveAcs</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">retrieve_acs_data</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">tract</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">saveAcs</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of Columns 17
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B19001_001E_Total</th>
      <th>B19001_002E_Total_Less_than_$10,000</th>
      <th>B19001_003E_Total_$10,000_to_$14,999</th>
      <th>B19001_004E_Total_$15,000_to_$19,999</th>
      <th>B19001_005E_Total_$20,000_to_$24,999</th>
      <th>B19001_006E_Total_$25,000_to_$29,999</th>
      <th>B19001_007E_Total_$30,000_to_$34,999</th>
      <th>B19001_008E_Total_$35,000_to_$39,999</th>
      <th>B19001_009E_Total_$40,000_to_$44,999</th>
      <th>B19001_010E_Total_$45,000_to_$49,999</th>
      <th>B19001_011E_Total_$50,000_to_$59,999</th>
      <th>B19001_012E_Total_$60,000_to_$74,999</th>
      <th>B19001_013E_Total_$75,000_to_$99,999</th>
      <th>B19001_014E_Total_$100,000_to_$124,999</th>
      <th>B19001_015E_Total_$125,000_to_$149,999</th>
      <th>B19001_016E_Total_$150,000_to_$199,999</th>
      <th>B19001_017E_Total_$200,000_or_more</th>
      <th>state</th>
      <th>county</th>
      <th>tract</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Census Tract 2710.02</th>
      <td>1510</td>
      <td>209</td>
      <td>73</td>
      <td>94</td>
      <td>97</td>
      <td>110</td>
      <td>119</td>
      <td>97</td>
      <td>65</td>
      <td>36</td>
      <td>149</td>
      <td>168</td>
      <td>106</td>
      <td>66</td>
      <td>44</td>
      <td>50</td>
      <td>27</td>
      <td>24</td>
      <td>510</td>
      <td>271002</td>
    </tr>
    <tr>
      <th>Census Tract 2604.02</th>
      <td>1134</td>
      <td>146</td>
      <td>29</td>
      <td>73</td>
      <td>80</td>
      <td>41</td>
      <td>91</td>
      <td>49</td>
      <td>75</td>
      <td>81</td>
      <td>170</td>
      <td>57</td>
      <td>162</td>
      <td>63</td>
      <td>11</td>
      <td>6</td>
      <td>0</td>
      <td>24</td>
      <td>510</td>
      <td>260402</td>
    </tr>
    <tr>
      <th>Census Tract 2712</th>
      <td>2276</td>
      <td>69</td>
      <td>43</td>
      <td>41</td>
      <td>22</td>
      <td>46</td>
      <td>67</td>
      <td>0</td>
      <td>30</td>
      <td>30</td>
      <td>80</td>
      <td>146</td>
      <td>321</td>
      <td>216</td>
      <td>139</td>
      <td>261</td>
      <td>765</td>
      <td>24</td>
      <td>510</td>
      <td>271200</td>
    </tr>
    <tr>
      <th>Census Tract 2804.04</th>
      <td>961</td>
      <td>111</td>
      <td>108</td>
      <td>61</td>
      <td>42</td>
      <td>56</td>
      <td>37</td>
      <td>73</td>
      <td>30</td>
      <td>31</td>
      <td>106</td>
      <td>119</td>
      <td>74</td>
      <td>23</td>
      <td>27</td>
      <td>24</td>
      <td>39</td>
      <td>24</td>
      <td>510</td>
      <td>280404</td>
    </tr>
    <tr>
      <th>Census Tract 901</th>
      <td>1669</td>
      <td>158</td>
      <td>124</td>
      <td>72</td>
      <td>48</td>
      <td>108</td>
      <td>68</td>
      <td>121</td>
      <td>137</td>
      <td>99</td>
      <td>109</td>
      <td>191</td>
      <td>160</td>
      <td>141</td>
      <td>28</td>
      <td>88</td>
      <td>17</td>
      <td>24</td>
      <td>510</td>
      <td>90100</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get-the-Secondary-Dataset">Get the Secondary Dataset<a class="anchor-link" href="#Get-the-Secondary-Dataset"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Spatial data can be attained by using the 2010 Census Tract Shapefile Picking <a href="https://www.census.gov/cgi-bin/geo/shapefiles/index.php?year=2010&amp;layergroup=Census+Tracts">Tool</a> or search their website for
Tiger/<a href="https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.2010.html">Line</a> Shapefiles</p>
<blockquote><p>The core TIGER/Line Files and Shapefiles do not include demographic data, but they do contain geographic entity codes (GEOIDs) that can be linked to the Census Bureau’s demographic data, available on data.census.gov.-census.gov</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For this example, we will simply pull a local dataset containing columns labeling tracts within Baltimore City and their corresponding CSA (Community Statistical Area). Typically, we use this dataset internally as a "crosswalk" where-upon a succesfull merge using the tract column, will be merged with a 3rd dataset along it's CSA column.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># !wget https://raw.githubusercontent.com/bniajfi/bniajfi/main/CSA-to-Tract-2010.csv</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>or, Alternately</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># !curl https://raw.githubusercontent.com/bniajfi/bniajfi/main/CSA-to-Tract-2010.csv	&gt; CSA-to-Tract-2010.csv</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Boundaries Example:CSA-to-Tract-2010.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Boundaries Example:CSA-to-Tract-2010.csv
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Our Example dataset contains Polygon Geometry information. </span>
<span class="c1"># We want to merge this over to our principle dataset. </span>
<span class="c1"># we will grab it by matching on either CSA or Tract</span>

<span class="c1"># The url listed below is public.</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tract 2 CSA Crosswalk : CSA-to-Tract-2010.csv&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">dataplay.intaker</span> <span class="kn">import</span> <span class="n">Intake</span>

<span class="n">crosswalk</span> <span class="o">=</span> <span class="n">Intake</span><span class="o">.</span><span class="n">getData</span><span class="p">(</span> <span class="s1">&#39;https://raw.githubusercontent.com/bniajfi/bniajfi/main/CSA-to-Tract-2010.csv&#39;</span> <span class="p">)</span> 
<span class="n">crosswalk</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Tract 2 CSA Crosswalk : CSA-to-Tract-2010.csv
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TRACTCE10</th>
      <th>GEOID10</th>
      <th>CSA2010</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10100</td>
      <td>24510010100</td>
      <td>Canton</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10200</td>
      <td>24510010200</td>
      <td>Patterson Park N...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10300</td>
      <td>24510010300</td>
      <td>Canton</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10400</td>
      <td>24510010400</td>
      <td>Canton</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10500</td>
      <td>24510010500</td>
      <td>Fells Point</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">crosswalk</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;TRACTCE10&#39;, &#39;GEOID10&#39;, &#39;CSA2010&#39;], dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Perform-Merge-&amp;-Save">Perform Merge &amp; Save<a class="anchor-link" href="#Perform-Merge-&amp;-Save"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following picture does nothing important but serves as a friendly reminder of the 4 basic join types.</p>
<image src="https://docs.trifacta.com/download/attachments/123830435/JoinVennDiagram.png" height='200px'/>

<ul>
<li>Left - returns all left records, only includes the right record if it has a match</li>
<li>Right - Returns all right records, only includes the left record if it has a match </li>
<li>Full - Returns all records regardless of keys matching</li>
<li>Inner - Returns only records where a key match</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Get Columns from both datasets to match on</p>
<p>You can get these values from the column values above.</p>
<p>Our Examples will work with the prompted values</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Princpal Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">left_on</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Left on crosswalk column: (&#39;tract&#39;) </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;tract&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span><span class="p">);</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Crosswalk Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">crosswalk</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">right_on</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Right on crosswalk column: (&#39;TRACTCE10&#39;) </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;TRACTCE10&quot;</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Princpal Columns Index([&#39;B19001_001E_Total&#39;, &#39;B19001_002E_Total_Less_than_$10,000&#39;,
       &#39;B19001_003E_Total_$10,000_to_$14,999&#39;,
       &#39;B19001_004E_Total_$15,000_to_$19,999&#39;,
       &#39;B19001_005E_Total_$20,000_to_$24,999&#39;,
       &#39;B19001_006E_Total_$25,000_to_$29,999&#39;,
       &#39;B19001_007E_Total_$30,000_to_$34,999&#39;,
       &#39;B19001_008E_Total_$35,000_to_$39,999&#39;,
       &#39;B19001_009E_Total_$40,000_to_$44,999&#39;,
       &#39;B19001_010E_Total_$45,000_to_$49,999&#39;,
       &#39;B19001_011E_Total_$50,000_to_$59,999&#39;,
       &#39;B19001_012E_Total_$60,000_to_$74,999&#39;,
       &#39;B19001_013E_Total_$75,000_to_$99,999&#39;,
       &#39;B19001_014E_Total_$100,000_to_$124,999&#39;,
       &#39;B19001_015E_Total_$125,000_to_$149,999&#39;,
       &#39;B19001_016E_Total_$150,000_to_$199,999&#39;,
       &#39;B19001_017E_Total_$200,000_or_more&#39;, &#39;state&#39;, &#39;county&#39;, &#39;tract&#39;],
      dtype=&#39;object&#39;)
Left on crosswalk column: (&#39;tract&#39;) 

 
 
Crosswalk Columns Index([&#39;TRACTCE10&#39;, &#39;GEOID10&#39;, &#39;CSA2010&#39;], dtype=&#39;object&#39;)
Right on crosswalk column: (&#39;TRACTCE10&#39;) 

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Specify how the merge will be performed</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will perform a left merge in this example.</p>
<p>It will return our Principal dataset with columns from the second dataset appended to records where their specified columns match.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">how</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;How: (‘left’, ‘right’, ‘outer’, ‘inner’) &quot;</span> <span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;outer&#39;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>How: (‘left’, ‘right’, ‘outer’, ‘inner’) 
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Actually perfrom the merge</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">crosswalk</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="n">right_on</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">)</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">left_on</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B19001_001E_Total</th>
      <th>B19001_002E_Total_Less_than_$10,000</th>
      <th>B19001_003E_Total_$10,000_to_$14,999</th>
      <th>B19001_004E_Total_$15,000_to_$19,999</th>
      <th>B19001_005E_Total_$20,000_to_$24,999</th>
      <th>B19001_006E_Total_$25,000_to_$29,999</th>
      <th>B19001_007E_Total_$30,000_to_$34,999</th>
      <th>B19001_008E_Total_$35,000_to_$39,999</th>
      <th>B19001_009E_Total_$40,000_to_$44,999</th>
      <th>B19001_010E_Total_$45,000_to_$49,999</th>
      <th>B19001_011E_Total_$50,000_to_$59,999</th>
      <th>B19001_012E_Total_$60,000_to_$74,999</th>
      <th>B19001_013E_Total_$75,000_to_$99,999</th>
      <th>B19001_014E_Total_$100,000_to_$124,999</th>
      <th>B19001_015E_Total_$125,000_to_$149,999</th>
      <th>B19001_016E_Total_$150,000_to_$199,999</th>
      <th>B19001_017E_Total_$200,000_or_more</th>
      <th>state</th>
      <th>county</th>
      <th>TRACTCE10</th>
      <th>GEOID10</th>
      <th>CSA2010</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>568</td>
      <td>128</td>
      <td>24</td>
      <td>44</td>
      <td>41</td>
      <td>4</td>
      <td>25</td>
      <td>20</td>
      <td>0</td>
      <td>21</td>
      <td>18</td>
      <td>31</td>
      <td>129</td>
      <td>32</td>
      <td>37</td>
      <td>9</td>
      <td>5</td>
      <td>24</td>
      <td>510</td>
      <td>130805.0</td>
      <td>2.45e+10</td>
      <td>Mount Washington...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>967</td>
      <td>99</td>
      <td>40</td>
      <td>25</td>
      <td>81</td>
      <td>77</td>
      <td>21</td>
      <td>42</td>
      <td>47</td>
      <td>5</td>
      <td>41</td>
      <td>100</td>
      <td>132</td>
      <td>68</td>
      <td>79</td>
      <td>82</td>
      <td>28</td>
      <td>24</td>
      <td>510</td>
      <td>210100.0</td>
      <td>2.45e+10</td>
      <td>Washington Villa...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1139</td>
      <td>191</td>
      <td>93</td>
      <td>81</td>
      <td>67</td>
      <td>63</td>
      <td>41</td>
      <td>51</td>
      <td>76</td>
      <td>68</td>
      <td>50</td>
      <td>120</td>
      <td>114</td>
      <td>22</td>
      <td>0</td>
      <td>33</td>
      <td>69</td>
      <td>24</td>
      <td>510</td>
      <td>270701.0</td>
      <td>2.45e+10</td>
      <td>Harford/Echodale</td>
    </tr>
    <tr>
      <th>3</th>
      <td>808</td>
      <td>195</td>
      <td>114</td>
      <td>80</td>
      <td>49</td>
      <td>76</td>
      <td>81</td>
      <td>26</td>
      <td>70</td>
      <td>0</td>
      <td>33</td>
      <td>19</td>
      <td>31</td>
      <td>13</td>
      <td>0</td>
      <td>15</td>
      <td>6</td>
      <td>24</td>
      <td>510</td>
      <td>190100.0</td>
      <td>2.45e+10</td>
      <td>Southwest Baltimore</td>
    </tr>
    <tr>
      <th>4</th>
      <td>698</td>
      <td>58</td>
      <td>69</td>
      <td>131</td>
      <td>32</td>
      <td>39</td>
      <td>26</td>
      <td>19</td>
      <td>24</td>
      <td>32</td>
      <td>60</td>
      <td>74</td>
      <td>55</td>
      <td>5</td>
      <td>34</td>
      <td>21</td>
      <td>19</td>
      <td>24</td>
      <td>510</td>
      <td>190200.0</td>
      <td>2.45e+10</td>
      <td>Southwest Baltimore</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see, our Census data will now have a CSA appended to it.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># outFile = input(&quot;Please enter the new Filename to save the data to (&#39;acs_csa_merge_test&#39;: &quot; )</span>
<span class="c1"># merged_df.to_csv(outFile+&#39;.csv&#39;, quoting=csv.QUOTE_ALL) </span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Final-Result">Final Result<a class="anchor-link" href="#Final-Result"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">flag</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter a URL? If not ACS data will be used. (Y/N):  &quot;</span> <span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;N&quot;</span>
<span class="k">if</span> <span class="p">(</span><span class="n">flag</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span> <span class="ow">or</span> <span class="n">flag</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">):</span>
  <span class="n">left_df</span> <span class="o">=</span> <span class="n">Intake</span><span class="o">.</span><span class="n">getData</span><span class="p">(</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter the location of your Left file: &quot;</span> <span class="p">)</span> <span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">tract</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter tract id (*): &quot;</span> <span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;*&quot;</span>
  <span class="n">county</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter county id (510): &quot;</span> <span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;510&quot;</span>
  <span class="n">state</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter state id (24): &quot;</span> <span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;24&quot;</span>
  <span class="n">tableId</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter acs table id (B19001): &quot;</span> <span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;B19001&quot;</span>
  <span class="n">year</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter acs year (18): &quot;</span> <span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;18&quot;</span>
  <span class="n">saveAcs</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Save ACS? (Y/N): &quot;</span> <span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;N&quot;</span>
  <span class="n">left_df</span> <span class="o">=</span> <span class="n">retrieve_acs_data</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">tract</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">saveAcs</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;right_df Example: CSA-to-Tract-2010.csv&#39;</span><span class="p">)</span>

<span class="n">right_df</span> <span class="o">=</span> <span class="n">Intake</span><span class="o">.</span><span class="n">getData</span><span class="p">(</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter the location of your right_df file: &quot;</span> <span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;https://raw.githubusercontent.com/bniajfi/bniajfi/main/CSA-to-Tract-2010.csv&#39;</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;Left Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">left_df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;right_df Columns &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">right_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">left_on</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Left on: &quot;</span> <span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;tract&#39;</span>
<span class="n">right_on</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Right on: &quot;</span> <span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;TRACTCE10&#39;</span>
<span class="n">how</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;How: (‘left’, ‘right’, ‘outer’, ‘inner’) &quot;</span> <span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;outer&#39;</span>

<span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left_df</span><span class="p">,</span> <span class="n">right_df</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="n">left_on</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="n">right_on</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">)</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">left_on</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Save the data</span>
<span class="c1"># Save the data</span>
<span class="n">saveFile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Save File (&#39;Y&#39; or &#39;N&#39;): &quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;N&#39;</span>
<span class="k">if</span> <span class="n">saveFile</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span> <span class="ow">or</span> <span class="n">saveFile</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
  <span class="n">outFile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Saved Filename (Do not include the file extension ): &quot;</span><span class="p">)</span>
  <span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outFile</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_ALL</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Enter a URL? If not ACS data will be used. (Y/N):  
Please enter tract id (*): 
Please enter county id (510): 
Please enter state id (24): 
Please enter acs table id (B19001): 
Please enter acs year (18): 
Save ACS? (Y/N): 
Number of Columns 17
right_df Example: CSA-to-Tract-2010.csv
Please enter the location of your right_df file: 
Left Columns Index([&#39;B19001_001E_Total&#39;, &#39;B19001_002E_Total_Less_than_$10,000&#39;,
       &#39;B19001_003E_Total_$10,000_to_$14,999&#39;,
       &#39;B19001_004E_Total_$15,000_to_$19,999&#39;,
       &#39;B19001_005E_Total_$20,000_to_$24,999&#39;,
       &#39;B19001_006E_Total_$25,000_to_$29,999&#39;,
       &#39;B19001_007E_Total_$30,000_to_$34,999&#39;,
       &#39;B19001_008E_Total_$35,000_to_$39,999&#39;,
       &#39;B19001_009E_Total_$40,000_to_$44,999&#39;,
       &#39;B19001_010E_Total_$45,000_to_$49,999&#39;,
       &#39;B19001_011E_Total_$50,000_to_$59,999&#39;,
       &#39;B19001_012E_Total_$60,000_to_$74,999&#39;,
       &#39;B19001_013E_Total_$75,000_to_$99,999&#39;,
       &#39;B19001_014E_Total_$100,000_to_$124,999&#39;,
       &#39;B19001_015E_Total_$125,000_to_$149,999&#39;,
       &#39;B19001_016E_Total_$150,000_to_$199,999&#39;,
       &#39;B19001_017E_Total_$200,000_or_more&#39;, &#39;state&#39;, &#39;county&#39;, &#39;tract&#39;],
      dtype=&#39;object&#39;)

 
right_df Columns Index([&#39;TRACTCE10&#39;, &#39;GEOID10&#39;, &#39;CSA2010&#39;], dtype=&#39;object&#39;)

Left on: 
Right on: 
How: (‘left’, ‘right’, ‘outer’, ‘inner’) 
Save File (&#39;Y&#39; or &#39;N&#39;): 
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">merged_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B19001_001E_Total</th>
      <th>B19001_002E_Total_Less_than_$10,000</th>
      <th>B19001_003E_Total_$10,000_to_$14,999</th>
      <th>B19001_004E_Total_$15,000_to_$19,999</th>
      <th>B19001_005E_Total_$20,000_to_$24,999</th>
      <th>B19001_006E_Total_$25,000_to_$29,999</th>
      <th>B19001_007E_Total_$30,000_to_$34,999</th>
      <th>B19001_008E_Total_$35,000_to_$39,999</th>
      <th>B19001_009E_Total_$40,000_to_$44,999</th>
      <th>B19001_010E_Total_$45,000_to_$49,999</th>
      <th>B19001_011E_Total_$50,000_to_$59,999</th>
      <th>B19001_012E_Total_$60,000_to_$74,999</th>
      <th>B19001_013E_Total_$75,000_to_$99,999</th>
      <th>B19001_014E_Total_$100,000_to_$124,999</th>
      <th>B19001_015E_Total_$125,000_to_$149,999</th>
      <th>B19001_016E_Total_$150,000_to_$199,999</th>
      <th>B19001_017E_Total_$200,000_or_more</th>
      <th>state</th>
      <th>county</th>
      <th>TRACTCE10</th>
      <th>GEOID10</th>
      <th>CSA2010</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>568</td>
      <td>128</td>
      <td>24</td>
      <td>44</td>
      <td>41</td>
      <td>4</td>
      <td>25</td>
      <td>20</td>
      <td>0</td>
      <td>21</td>
      <td>18</td>
      <td>31</td>
      <td>129</td>
      <td>32</td>
      <td>37</td>
      <td>9</td>
      <td>5</td>
      <td>24</td>
      <td>510</td>
      <td>130805.0</td>
      <td>2.45e+10</td>
      <td>Mount Washington...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Advanced">Advanced<a class="anchor-link" href="#Advanced"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For this next example to work, we will need to import hypothetical csv files</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Intro</strong></p>
<p>The following Python function is a bulked out version of the previous notes.</p>
<ul>
<li>It contains everything from the tutorial plus more.</li>
<li>It can be imported and used in future projects or stand alone.</li>
</ul>
<p><strong>Description:</strong> add columns of data from a foreign dataset into a primary dataset along set parameters.</p>
<p><strong>Purpose:</strong> Makes Merging datasets simple</p>
<p><strong>Services</strong></p>
<ul>
<li>Merge two datasets without a crosswalk</li>
<li>Merge two datasets with a crosswalk</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="mergeDatasets" class="doc_header"><code>mergeDatasets</code><a href="https://github.com/bniajfi/dataplay/tree/main/dataplay/merge.py#L20" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>mergeDatasets</code>(<strong><code>left_ds</code></strong>=<em><code>False</code></em>, <strong><code>right_ds</code></strong>=<em><code>False</code></em>, <strong><code>crosswalk_ds</code></strong>=<em><code>False</code></em>, <strong><code>left_col</code></strong>=<em><code>False</code></em>, <strong><code>right_col</code></strong>=<em><code>False</code></em>, <strong><code>crosswalk_left_col</code></strong>=<em><code>False</code></em>, <strong><code>crosswalk_right_col</code></strong>=<em><code>False</code></em>, <strong><code>merge_how</code></strong>=<em><code>False</code></em>, <strong><code>interactive</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Function-Explanation">Function Explanation<a class="anchor-link" href="#Function-Explanation"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Input(s):</strong></p>
<ul>
<li>Dataset url</li>
<li>Crosswalk Url </li>
<li>Right On </li>
<li>Left On </li>
<li>How </li>
<li>New Filename </li>
</ul>
<p><strong>Output:</strong> File</p>
<p><strong>How it works:</strong></p>
<ul>
<li>Read in datasets</li>
<li><p>Perform Merge</p>
</li>
<li><p>If the 'how' parameter is equal to ['left', 'right', 'outer', 'inner']</p>
</li>
<li><ul>
<li>then a merge will be performed. </li>
</ul>
</li>
<li>If a column name is provided in the 'how' parameter</li>
<li><ul>
<li>then that single column will be pulled from the right dataset as a new column in the left_ds.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Function-Diagrams">Function Diagrams<a class="anchor-link" href="#Function-Diagrams"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Diagram the mergeDatasets()</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">html</span>
&lt;img src=&quot;https://bniajfi.org/images/mermaid/class_diagram_merge_datasets.PNG&quot;&gt;
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<img src="https://bniajfi.org/images/mermaid/class_diagram_merge_datasets.PNG">
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>mergeDatasets Flow Chart</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">html</span>
&lt;img src=&quot;https://bniajfi.org/images/mermaid/flow_chart_merge_datasets.PNG&quot;&gt;
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<img src="https://bniajfi.org/images/mermaid/flow_chart_merge_datasets.PNG">
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Gannt Chart  mergeDatasets()</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">html</span>
&lt;img src=&quot;https://bniajfi.org/images/mermaid/gannt_chart_merge_datasets.PNG&quot;&gt;
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<img src="https://bniajfi.org/images/mermaid/gannt_chart_merge_datasets.PNG">
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sequence Diagram  mergeDatasets()</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">html</span>
&lt;img src=&quot;https://bniajfi.org/images/mermaid/sequence_diagram_merge_datasets.PNG&quot;&gt;
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<img src="https://bniajfi.org/images/mermaid/sequence_diagram_merge_datasets.PNG">
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Function-Examples">Function Examples<a class="anchor-link" href="#Function-Examples"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># from dataplay.geoms import readInGeometryData </span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Interactive-Example-1.-Merge-Esri-Data">Interactive Example 1. Merge Esri Data<a class="anchor-link" href="#Interactive-Example-1.-Merge-Esri-Data"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Hhchpov = Intake.getData(&quot;https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhchpov/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson&quot;, interactive=True)</span>
<span class="c1"># Hhchpov = Hhchpov[[&#39;CSA2010&#39;, &#39;hhchpov15&#39;,	&#39;hhchpov16&#39;,	&#39;hhchpov17&#39;,	&#39;hhchpov18&#39;]] </span>
<span class="n">left_ds</span> <span class="o">=</span> <span class="s2">&quot;https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhchpov/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson&quot;</span>
<span class="n">left_col</span> <span class="o">=</span> <span class="s1">&#39;CSA2010&#39;</span>

<span class="c1"># Table: Household Poverty </span>
<span class="c1"># Hhpov = Intake.getData(&quot;https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhpov/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson&quot;, interactive=True)</span>
<span class="c1"># Hhpov = Hhpov[[&#39;CSA2010&#39;, &#39;hhpov15&#39;,	&#39;hhpov16&#39;,	&#39;hhpov17&#39;,	&#39;hhpov18&#39;]] </span>
<span class="n">right_ds</span> <span class="o">=</span> <span class="s2">&quot;https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhpov/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson&quot;</span>
<span class="n">right_col</span><span class="o">=</span><span class="s1">&#39;CSA2010&#39;</span>

<span class="n">merge_how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span>
<span class="n">interactive</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">merged_df</span> <span class="o">=</span> <span class="n">mergeDatasets</span><span class="p">(</span><span class="n">left_ds</span><span class="o">=</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">right_ds</span><span class="o">=</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">crosswalk_ds</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">,</span>
                  <span class="n">left_col</span><span class="o">=</span><span class="n">left_col</span><span class="p">,</span> <span class="n">right_col</span><span class="o">=</span><span class="n">right_col</span><span class="p">,</span>
                  <span class="n">crosswalk_left_col</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">crosswalk_right_col</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                  <span class="n">merge_how</span><span class="o">=</span><span class="n">merge_how</span><span class="p">,</span> <span class="c1"># left right or columnname to retrieve</span>
                  <span class="n">interactive</span><span class="o">=</span><span class="n">interactive</span><span class="p">)</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OBJECTID_x</th>
      <th>CSA2010</th>
      <th>hhchpov15</th>
      <th>hhchpov16</th>
      <th>hhchpov17</th>
      <th>hhchpov18</th>
      <th>hhchpov19</th>
      <th>Shape__Area_x</th>
      <th>Shape__Length_x</th>
      <th>geometry_x</th>
      <th>OBJECTID_y</th>
      <th>hhpov15</th>
      <th>hhpov16</th>
      <th>hhpov17</th>
      <th>hhpov18</th>
      <th>hhpov19</th>
      <th>Shape__Area_y</th>
      <th>Shape__Length_y</th>
      <th>geometry_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Allendale/Irving...</td>
      <td>38.93</td>
      <td>34.73</td>
      <td>32.77</td>
      <td>35.27</td>
      <td>32.60</td>
      <td>6.38e+07</td>
      <td>38770.17</td>
      <td>POLYGON ((-76.65...</td>
      <td>1</td>
      <td>24.15</td>
      <td>21.28</td>
      <td>20.70</td>
      <td>23.00</td>
      <td>19.18</td>
      <td>6.38e+07</td>
      <td>38770.17</td>
      <td>POLYGON ((-76.65...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Beechfield/Ten H...</td>
      <td>19.42</td>
      <td>21.22</td>
      <td>23.92</td>
      <td>21.90</td>
      <td>15.38</td>
      <td>4.79e+07</td>
      <td>37524.95</td>
      <td>POLYGON ((-76.69...</td>
      <td>2</td>
      <td>11.17</td>
      <td>11.59</td>
      <td>10.47</td>
      <td>10.90</td>
      <td>8.82</td>
      <td>4.79e+07</td>
      <td>37524.95</td>
      <td>POLYGON ((-76.69...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Belair-Edison</td>
      <td>36.88</td>
      <td>36.13</td>
      <td>34.56</td>
      <td>39.74</td>
      <td>41.04</td>
      <td>4.50e+07</td>
      <td>31307.31</td>
      <td>POLYGON ((-76.56...</td>
      <td>3</td>
      <td>18.61</td>
      <td>19.59</td>
      <td>20.27</td>
      <td>22.83</td>
      <td>22.53</td>
      <td>4.50e+07</td>
      <td>31307.31</td>
      <td>POLYGON ((-76.56...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Brooklyn/Curtis ...</td>
      <td>45.01</td>
      <td>46.45</td>
      <td>46.41</td>
      <td>39.89</td>
      <td>41.39</td>
      <td>1.76e+08</td>
      <td>150987.70</td>
      <td>MULTIPOLYGON (((...</td>
      <td>4</td>
      <td>28.36</td>
      <td>26.33</td>
      <td>24.21</td>
      <td>21.54</td>
      <td>24.60</td>
      <td>1.76e+08</td>
      <td>150987.70</td>
      <td>MULTIPOLYGON (((...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Canton</td>
      <td>5.49</td>
      <td>2.99</td>
      <td>4.02</td>
      <td>4.61</td>
      <td>4.83</td>
      <td>1.54e+07</td>
      <td>23338.61</td>
      <td>POLYGON ((-76.57...</td>
      <td>5</td>
      <td>3.00</td>
      <td>2.26</td>
      <td>3.66</td>
      <td>2.05</td>
      <td>2.22</td>
      <td>1.54e+07</td>
      <td>23338.61</td>
      <td>POLYGON ((-76.57...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Example-2-)-Get-CSA-and-Geometry-with-a-Crosswalk-using-3-links">Example 2 ) Get CSA and Geometry with a Crosswalk using 3 links<a class="anchor-link" href="#Example-2-)-Get-CSA-and-Geometry-with-a-Crosswalk-using-3-links"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Change these values in the cell below using different geographic reference codes will change those parameters</span>
<span class="n">tract</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span>
<span class="n">county</span> <span class="o">=</span> <span class="s1">&#39;510&#39;</span> <span class="c1"># &#39;059&#39; # 153 &#39;510&#39;</span>
<span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;24&#39;</span> <span class="c1">#51</span>
 
<span class="c1"># Specify the download parameters the function will receieve here</span>
<span class="n">tableId</span> <span class="o">=</span> <span class="s1">&#39;B19049&#39;</span> <span class="c1"># &#39;B19001&#39;</span>
<span class="n">year</span> <span class="o">=</span> <span class="s1">&#39;17&#39;</span>
<span class="n">saveAcs</span> <span class="o">=</span> <span class="kc">False</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">IPython</span> 
<span class="c1"># from IPython.core.display import HTML</span>
<span class="n">IPython</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;style&gt;.rendered_html th {max-width: 200px; overflow:auto;}&lt;/style&gt;&quot;</span><span class="p">)</span>
<span class="c1"># state, county, tract, tableId, year, saveOriginal, save </span>
<span class="n">left_df</span> <span class="o">=</span> <span class="n">retrieve_acs_data</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">county</span><span class="p">,</span> <span class="n">tract</span><span class="p">,</span> <span class="n">tableId</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">saveAcs</span><span class="p">)</span>
<span class="n">left_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<style>.rendered_html th {max-width: 200px; overflow:auto;}</style>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of Columns 5
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B19049_001E_Median_household_income_in_the_past_12_months_(in_2017_inflation-adjusted_dollars)_--_Total</th>
      <th>B19049_002E_Median_household_income_in_the_past_12_months_(in_2017_inflation-adjusted_dollars)_--_Householder_under_25_years</th>
      <th>B19049_003E_Median_household_income_in_the_past_12_months_(in_2017_inflation-adjusted_dollars)_--_Householder_25_to_44_years</th>
      <th>B19049_004E_Median_household_income_in_the_past_12_months_(in_2017_inflation-adjusted_dollars)_--_Householder_45_to_64_years</th>
      <th>B19049_005E_Median_household_income_in_the_past_12_months_(in_2017_inflation-adjusted_dollars)_--_Householder_65_years_and_over</th>
      <th>state</th>
      <th>county</th>
      <th>tract</th>
    </tr>
    <tr>
      <th>NAME</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Census Tract 2710.02</th>
      <td>38358</td>
      <td>-666666666</td>
      <td>34219</td>
      <td>40972</td>
      <td>37143</td>
      <td>24</td>
      <td>510</td>
      <td>271002</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Columns: Address(es), Census Tract</span>
<span class="n">left_ds</span> <span class="o">=</span> <span class="n">left_df</span>
<span class="n">left_col</span> <span class="o">=</span> <span class="s1">&#39;tract&#39;</span>

<span class="c1"># Table: Crosswalk Census Communities</span>
<span class="c1"># &#39;TRACT2010&#39;, &#39;GEOID2010&#39;, &#39;CSA2010&#39;</span>
<span class="n">crosswalk_ds</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/bniajfi/bniajfi/main/CSA-to-Tract-2010.csv&#39;</span>
<span class="n">crosswalk_left_col</span> <span class="o">=</span> <span class="s1">&#39;TRACTCE10&#39;</span>
<span class="n">crosswalk_right_col</span> <span class="o">=</span> <span class="s1">&#39;CSA2010&#39;</span>

<span class="c1"># Table: </span>
<span class="n">right_ds</span> <span class="o">=</span> <span class="s1">&#39;https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhpov/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson&#39;</span>
<span class="n">right_col</span> <span class="o">=</span> <span class="s1">&#39;CSA2010&#39;</span>

<span class="n">interactive</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">merge_how</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span>

<span class="n">merged_df_geom</span> <span class="o">=</span> <span class="n">mergeDatasets</span><span class="p">(</span><span class="n">left_ds</span><span class="o">=</span><span class="n">left_ds</span><span class="p">,</span> <span class="n">right_ds</span><span class="o">=</span><span class="n">right_ds</span><span class="p">,</span> <span class="n">crosswalk_ds</span><span class="o">=</span><span class="n">crosswalk_ds</span><span class="p">,</span>
                  <span class="n">left_col</span><span class="o">=</span><span class="n">left_col</span><span class="p">,</span> <span class="n">right_col</span><span class="o">=</span><span class="n">right_col</span><span class="p">,</span>
                  <span class="n">crosswalk_left_col</span> <span class="o">=</span> <span class="n">crosswalk_left_col</span><span class="p">,</span> <span class="n">crosswalk_right_col</span> <span class="o">=</span> <span class="n">crosswalk_right_col</span><span class="p">,</span>
                  <span class="n">merge_how</span><span class="o">=</span><span class="n">merge_how</span><span class="p">,</span> <span class="c1"># left right or columnname to retrieve</span>
                  <span class="n">interactive</span><span class="o">=</span><span class="n">interactive</span><span class="p">)</span>

<span class="n">merged_df_geom</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>crosswalk_left_col TRACTCE10
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B19049_001E_Median_household_income_in_the_past_12_months_(in_2017_inflation-adjusted_dollars)_--_Total</th>
      <th>B19049_002E_Median_household_income_in_the_past_12_months_(in_2017_inflation-adjusted_dollars)_--_Householder_under_25_years</th>
      <th>B19049_003E_Median_household_income_in_the_past_12_months_(in_2017_inflation-adjusted_dollars)_--_Householder_25_to_44_years</th>
      <th>B19049_004E_Median_household_income_in_the_past_12_months_(in_2017_inflation-adjusted_dollars)_--_Householder_45_to_64_years</th>
      <th>B19049_005E_Median_household_income_in_the_past_12_months_(in_2017_inflation-adjusted_dollars)_--_Householder_65_years_and_over</th>
      <th>state</th>
      <th>county</th>
      <th>tract</th>
      <th>CSA2010</th>
      <th>OBJECTID</th>
      <th>hhpov15</th>
      <th>hhpov16</th>
      <th>hhpov17</th>
      <th>hhpov18</th>
      <th>hhpov19</th>
      <th>Shape__Area</th>
      <th>Shape__Length</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>38358</td>
      <td>-666666666</td>
      <td>34219</td>
      <td>40972</td>
      <td>37143</td>
      <td>24</td>
      <td>510</td>
      <td>271002</td>
      <td>Greater Govans</td>
      <td>20.0</td>
      <td>21.32</td>
      <td>19.27</td>
      <td>19.53</td>
      <td>17.99</td>
      <td>20.50</td>
      <td>2.27e+07</td>
      <td>22982.13</td>
      <td>POLYGON ((-76.59...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44904</td>
      <td>-666666666</td>
      <td>51324</td>
      <td>42083</td>
      <td>37269</td>
      <td>24</td>
      <td>510</td>
      <td>90100</td>
      <td>Greater Govans</td>
      <td>20.0</td>
      <td>21.32</td>
      <td>19.27</td>
      <td>19.53</td>
      <td>17.99</td>
      <td>20.50</td>
      <td>2.27e+07</td>
      <td>22982.13</td>
      <td>POLYGON ((-76.59...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>35707</td>
      <td>2499</td>
      <td>42292</td>
      <td>37361</td>
      <td>29191</td>
      <td>24</td>
      <td>510</td>
      <td>271001</td>
      <td>Greater Govans</td>
      <td>20.0</td>
      <td>21.32</td>
      <td>19.27</td>
      <td>19.53</td>
      <td>17.99</td>
      <td>20.50</td>
      <td>2.27e+07</td>
      <td>22982.13</td>
      <td>POLYGON ((-76.59...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>42231</td>
      <td>-666666666</td>
      <td>46467</td>
      <td>45484</td>
      <td>18750</td>
      <td>24</td>
      <td>510</td>
      <td>260402</td>
      <td>Claremont/Armistead</td>
      <td>9.0</td>
      <td>21.27</td>
      <td>23.59</td>
      <td>24.00</td>
      <td>24.64</td>
      <td>23.88</td>
      <td>6.12e+07</td>
      <td>40104.42</td>
      <td>POLYGON ((-76.52...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31657</td>
      <td>20800</td>
      <td>26074</td>
      <td>60959</td>
      <td>37396</td>
      <td>24</td>
      <td>510</td>
      <td>260403</td>
      <td>Claremont/Armistead</td>
      <td>9.0</td>
      <td>21.27</td>
      <td>23.59</td>
      <td>24.00</td>
      <td>24.64</td>
      <td>23.88</td>
      <td>6.12e+07</td>
      <td>40104.42</td>
      <td>POLYGON ((-76.52...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we can save the data so that it may be used in later tutorials.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># merged_df.to_csv(string+&#39;.csv&#39;, encoding=&quot;utf-8&quot;, index=False, quoting=csv.QUOTE_ALL)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Example-3:-Ran-Alone">Example 3: Ran Alone<a class="anchor-link" href="#Example-3:-Ran-Alone"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mergeDatasets</span><span class="p">(</span> <span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>---Handling Left Dataset Options---
Getting Data From:  False
Error: Try Again?  ( URL/ PATH or  &#39;NO&#39;/ &lt;Empty&gt; ) https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhchpov/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Getting Data From:  https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhchpov/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Invalid column given:  False
Index([&#39;OBJECTID&#39;, &#39;CSA2010&#39;, &#39;hhchpov15&#39;, &#39;hhchpov16&#39;, &#39;hhchpov17&#39;,
       &#39;hhchpov18&#39;, &#39;hhchpov19&#39;, &#39;Shape__Area&#39;, &#39;Shape__Length&#39;, &#39;geometry&#39;],
      dtype=&#39;object&#39;)
Please enter a new column fom the list above.
Column Name: CSA2010
Left column: CSA2010

---Handling Right Dataset Options---
Getting Data From:  False
Error: Try Again?  ( URL/ PATH or  &#39;NO&#39;/ &lt;Empty&gt; ) https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhchpov/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Getting Data From:  https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhchpov/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Invalid column given:  False
Index([&#39;OBJECTID&#39;, &#39;CSA2010&#39;, &#39;hhchpov15&#39;, &#39;hhchpov16&#39;, &#39;hhchpov17&#39;,
       &#39;hhchpov18&#39;, &#39;hhchpov19&#39;, &#39;Shape__Area&#39;, &#39;Shape__Length&#39;, &#39;geometry&#39;],
      dtype=&#39;object&#39;)
Please enter a new column fom the list above.
Column Name: CSA2010
Right column: CSA2010

---Ensuring Compatability Between merge_how (val: &#39;False&#39;) and the Right Dataset---

 Invalid merge column given. 
 Please select a value from either list

 1) Pull A single column from the right dataset:  Index([&#39;OBJECTID&#39;, &#39;CSA2010&#39;, &#39;hhchpov15&#39;, &#39;hhchpov16&#39;, &#39;hhchpov17&#39;,
       &#39;hhchpov18&#39;, &#39;hhchpov19&#39;, &#39;Shape__Area&#39;, &#39;Shape__Length&#39;, &#39;geometry&#39;],
      dtype=&#39;object&#39;)
OR 
 2) Specify a type of join operation: (‘left’, ‘right’, ‘outer’, ‘inner’, columnName) 
Column Name: inner
Column or [&#39;inner&#39;,&#39;left&#39;,&#39;right&#39;,&#39;outer&#39;] value:  inner

---Checking Crosswalk Dataset Options---

Provide a Crosswalk? ( URL/ PATH or  &#39;NO&#39;/ &lt;Empty&gt;/ &#39;FALSE&#39; ) 

---Casting Datatypes from-to: Left-&gt;Right Datasets---
Before Casting: 
-&gt; Column One:  CSA2010 object
-&gt; Column Two:  CSA2010 object

 After Casting: 
-&gt; Column One:  CSA2010 object
-&gt; Column Two:  CSA2010 object

---All checks complete. Status:  True ---

---PERFORMING MERGE : LEFT-&gt;RIGHT---
Column One :  CSA2010 object
How:  inner
Column Two :  CSA2010 object
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OBJECTID_x</th>
      <th>CSA2010</th>
      <th>hhchpov15_x</th>
      <th>hhchpov16_x</th>
      <th>hhchpov17_x</th>
      <th>hhchpov18_x</th>
      <th>hhchpov19_x</th>
      <th>Shape__Area_x</th>
      <th>Shape__Length_x</th>
      <th>geometry_x</th>
      <th>OBJECTID_y</th>
      <th>hhchpov15_y</th>
      <th>hhchpov16_y</th>
      <th>hhchpov17_y</th>
      <th>hhchpov18_y</th>
      <th>hhchpov19_y</th>
      <th>Shape__Area_y</th>
      <th>Shape__Length_y</th>
      <th>geometry_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Allendale/Irving...</td>
      <td>38.93</td>
      <td>34.73</td>
      <td>32.77</td>
      <td>35.27</td>
      <td>32.6</td>
      <td>6.38e+07</td>
      <td>38770.17</td>
      <td>POLYGON ((-76.65...</td>
      <td>1</td>
      <td>38.93</td>
      <td>34.73</td>
      <td>32.77</td>
      <td>35.27</td>
      <td>32.6</td>
      <td>6.38e+07</td>
      <td>38770.17</td>
      <td>POLYGON ((-76.65...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mergeDatasets</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>---Handling Left Dataset Options---
Getting Data From:  False
Error: Try Again?  ( URL/ PATH or  &#39;NO&#39;/ &lt;Empty&gt; ) https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhchpov/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Getting Data From:  https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhchpov/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Invalid column given:  False
Index([&#39;OBJECTID&#39;, &#39;CSA2010&#39;, &#39;hhchpov15&#39;, &#39;hhchpov16&#39;, &#39;hhchpov17&#39;,
       &#39;hhchpov18&#39;, &#39;hhchpov19&#39;, &#39;Shape__Area&#39;, &#39;Shape__Length&#39;, &#39;geometry&#39;],
      dtype=&#39;object&#39;)
Please enter a new column fom the list above.
Column Name: CSA2010
Left column: CSA2010

---Handling Right Dataset Options---
Getting Data From:  False
Error: Try Again?  ( URL/ PATH or  &#39;NO&#39;/ &lt;Empty&gt; ) https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhchpov/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Getting Data From:  https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhchpov/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Invalid column given:  False
Index([&#39;OBJECTID&#39;, &#39;CSA2010&#39;, &#39;hhchpov15&#39;, &#39;hhchpov16&#39;, &#39;hhchpov17&#39;,
       &#39;hhchpov18&#39;, &#39;hhchpov19&#39;, &#39;Shape__Area&#39;, &#39;Shape__Length&#39;, &#39;geometry&#39;],
      dtype=&#39;object&#39;)
Please enter a new column fom the list above.
Column Name: CSA2010
Right column: CSA2010

---Ensuring Compatability Between merge_how (val: &#39;False&#39;) and the Right Dataset---

 Invalid merge column given. 
 Please select a value from either list

 1) Pull A single column from the right dataset:  Index([&#39;OBJECTID&#39;, &#39;CSA2010&#39;, &#39;hhchpov15&#39;, &#39;hhchpov16&#39;, &#39;hhchpov17&#39;,
       &#39;hhchpov18&#39;, &#39;hhchpov19&#39;, &#39;Shape__Area&#39;, &#39;Shape__Length&#39;, &#39;geometry&#39;],
      dtype=&#39;object&#39;)
OR 
 2) Specify a type of join operation: (‘left’, ‘right’, ‘outer’, ‘inner’, columnName) 
Column Name: inner
Column or [&#39;inner&#39;,&#39;left&#39;,&#39;right&#39;,&#39;outer&#39;] value:  inner

---Checking Crosswalk Dataset Options---

Provide a Crosswalk? ( URL/ PATH or  &#39;NO&#39;/ &lt;Empty&gt;/ &#39;FALSE&#39; ) https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhchpov/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Getting Data From:  https://services1.arcgis.com/mVFRs7NF4iFitgbY/ArcGIS/rest/services/Hhchpov/FeatureServer/0/query?where=1%3D1&amp;outFields=*&amp;returnGeometry=true&amp;f=pgeojson
Invalid column given:  False
Index([&#39;OBJECTID&#39;, &#39;CSA2010&#39;, &#39;hhchpov15&#39;, &#39;hhchpov16&#39;, &#39;hhchpov17&#39;,
       &#39;hhchpov18&#39;, &#39;hhchpov19&#39;, &#39;Shape__Area&#39;, &#39;Shape__Length&#39;, &#39;geometry&#39;],
      dtype=&#39;object&#39;)
Please enter a new column fom the list above.
Column Name: CSA2010
Invalid column given:  False
Index([&#39;OBJECTID&#39;, &#39;CSA2010&#39;, &#39;hhchpov15&#39;, &#39;hhchpov16&#39;, &#39;hhchpov17&#39;,
       &#39;hhchpov18&#39;, &#39;hhchpov19&#39;, &#39;Shape__Area&#39;, &#39;Shape__Length&#39;, &#39;geometry&#39;],
      dtype=&#39;object&#39;)
Please enter a new column fom the list above.
Column Name: CSA2010
crosswalk_left_col CSA2010

---Casting Datatypes from-to: Left-&gt;Crosswalk Datasets---
Before Casting: 
-&gt; Column One:  CSA2010 object
-&gt; Column Two:  CSA2010 object

 After Casting: 
-&gt; Column One:  CSA2010 object
-&gt; Column Two:  CSA2010 object

---Casting Datatypes from-to: Right-&gt;Crosswalk Datasets---
Before Casting: 
-&gt; Column One:  CSA2010 object
-&gt; Column Two:  CSA2010 object

 After Casting: 
-&gt; Column One:  CSA2010 object
-&gt; Column Two:  CSA2010 object

---All checks complete. Status:  True ---

---PERFORMING MERGE : LEFT-&gt;CROSSWALK---
Column One :  CSA2010 object
How:  CSA2010
Column Two :  CSA2010 object
---PERFORMING MERGE : LEFT-&gt;RIGHT---
Column One :  CSA2010 object
How:  inner
Column Two :  CSA2010 object
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>OBJECTID_x</th>
      <th>CSA2010</th>
      <th>hhchpov15_x</th>
      <th>hhchpov16_x</th>
      <th>hhchpov17_x</th>
      <th>hhchpov18_x</th>
      <th>hhchpov19_x</th>
      <th>Shape__Area_x</th>
      <th>Shape__Length_x</th>
      <th>geometry_x</th>
      <th>OBJECTID_y</th>
      <th>hhchpov15_y</th>
      <th>hhchpov16_y</th>
      <th>hhchpov17_y</th>
      <th>hhchpov18_y</th>
      <th>hhchpov19_y</th>
      <th>Shape__Area_y</th>
      <th>Shape__Length_y</th>
      <th>geometry_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Allendale/Irving...</td>
      <td>38.93</td>
      <td>34.73</td>
      <td>32.77</td>
      <td>35.27</td>
      <td>32.6</td>
      <td>6.38e+07</td>
      <td>38770.17</td>
      <td>POLYGON ((-76.65...</td>
      <td>1</td>
      <td>38.93</td>
      <td>34.73</td>
      <td>32.77</td>
      <td>35.27</td>
      <td>32.6</td>
      <td>6.38e+07</td>
      <td>38770.17</td>
      <td>POLYGON ((-76.65...</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

